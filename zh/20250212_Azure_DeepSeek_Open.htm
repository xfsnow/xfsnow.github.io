<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>雪峰博客</title><meta name="description" content="分享AI和云计算技术的最新动态与实践经验，以及其它有趣的话题。"><meta name="keywords" content="AI, GitHub Copilot, Azure云, 云计算, 前端技术, 后端技术, Web开发, 软件工程"><link rel="stylesheet" href="/assets/css/style.min.css"><link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v7.1.0/css/all.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css"></head><body><nav class="navbar"><div class="nav-container"><div class="nav-logo"><h2><i class="fas fa-snowflake"></i> Snowpeak</h2></div><div class="nav-menu"><a href="/" class="nav-link">首页</a><a href="/zh/page_1.htm" class="nav-link">文章</a><a href="/#tools" class="nav-link">工具</a><a href="/zh/about.htm" class="nav-link">关于</a><a href="/en/" class="nav-link lang-switch"><i class="fas fa-globe"></i> English</a></div><div class="nav-toggle" id="mobile-menu"><span class="bar"></span><span class="bar"></span><span class="bar"></span></div></div></nav><header class="article-header"><div class="container"><h1>在 Azure 上部署 DeepSeek 并集成 Open WebUI</h1><div class="article-meta"><span><i class="fas fa-calendar"></i> 发布时间: 2025-02-12 18:01:01</span><span><i class="fas fa-clock"></i> 阅读约需: 5 分钟 </span><span><i class="fas fa-tag"></i> 分类: AI</span></div></div></header><main class="article-container"><p>DeepSeek 是杭州深度求索人工智能基础技术研究有限公司发布的开源大模型，最近是持续火爆，使得官方服务经常不可用。网上各种本地部署和私有部署的文章已经很多，这里我们提供一个全部基于 Azure 的私有部署方案。</p><h2>使用 Azure AI Foundry 部署 DeepSeek</h2><p>Azure AI Foundry 是微软推出的一个 AI 服务平台，提供了一站式的 AI 服务，包括模型训练、推理、部署等等。创建 Azure AI Foundry 请参考 <a href="https://learn.microsoft.com/azure/ai-studio/how-to/create-projects" title="官方文档">官方文档</a> 。</p><p>我们可以使用 Azure AI Foundry 来部署 DeepSeek。</p><ol><li>开始部署 DeepSeek 模型</li></ol><p><img alt="Deploy DeepSeek in Azure AI Foundry" src="../assets/img/20250212_Azure_DeepSeek_Open_01.png"></p><ol><li>选择模型后，可以看到 DeepSeek 模型本身不要钱。(模型是开源免费的嘛)</li></ol><p><img alt="DeepSeek free" src="../assets/img/20250212_Azure_DeepSeek_Open_02.png"></p><p>涉及到 Azure 的计算资源，还是需要一点点钱的。具体的费用可以参考 <a href="https://azure.microsoft.com/zh-cn/pricing/details/machine-learning/" title="Azure 官方定价">Azure 官方定价</a></p><ol><li>无需更多配置了，点击“创建资源并部署”按钮，等待部署完成。</li></ol><p><img alt="DeepSeek free" src="../assets/img/20250212_Azure_DeepSeek_Open_03.png"></p><ol><li>部署完成后，可以看到 DeepSeek 模型的 Endpoint。</li></ol><p><img alt="DeepSeek deployed" src="../assets/img/20250212_Azure_DeepSeek_Open_04.png"></p><p>先记下模型的 Model Name，一般默认是 <code>DeepSeek-R1</code>，然后点击模型的 Get Endpoint 按钮。</p><p><img alt="DeepSeek endpoint" src="../assets/img/20250212_Azure_DeepSeek_Open_05.png"></p><p>记下模型的 Azure AI model inference endpoint 和 Key。上述 3 个值会在后续配置 Open WebUI 函数时用到。</p><h2>使用 Azure App Service 部署 Open WebUI</h2><p><a href="https://www.openwebui.com/" title="Open WebUI">Open WebUI</a> 是一个可扩展、功能丰富且用户友好的自托管 AI 平台，设计为完全离线运行。它支持多种 LLM 运行器（如 Ollama 和与 OpenAI 兼容的 API），并内置用于 RAG 的推理引擎，是一个功能强大的 AI 部署解决方案。虽然它支持多种方式本地安装，但毕竟体积较大，部署起来还是有一定难度。使用 Azure App Service 一健部署到云端，无需本地下载安装包或 Docker 镜像，非常方便。</p><h3>创建 App Service</h3><p>方法非常简便， 主要步骤如下：</p><ol><li>在 <a href="https://portal.azure.com/" title="Azure 门户">Azure 门户</a> 中搜索 App Service，然后点击左上角“创建”按钮，选择“Web 应用”。</li><li>按提示填写应用名称、资源组、区域等信息。以下几点需要注意： * Publish 选择 Container。 * Operating System 选择 Linux。 * Region 建议选择 Japan West，因为这个区域从网络访问来看中国大陆的访问速度较快。 * Pricing plans 选择 F1 Free，咱们自己用免费的足够了。</li><li>下一页 Database 不选。</li><li>Container 页，配置以下几点： * Image Source 选 Other container registries * Access Type 选 Public * Registry server URL 填写 <code>ghcr.io</code> * Image and tag 填写 <code>openwebui/openwebui:main</code></li></ol><p><img alt="App Service create" src="../assets/img/20250212_Azure_DeepSeek_Open_06.png"></p><ol><li>其它页都不用动，直接点击“查看 + 创建”按钮。</li></ol><p>稍等片刻，App Service 就创建好了。点击 Overview 页的 Default domain，就可以访问 Open WebUI 了。</p><p><img alt="App Service domain" src="../assets/img/20250212_Azure_DeepSeek_Open_07.png"></p><p>免费档资源规格较小，但 Open WebUI 镜像很大，加载也慢，启动需要5-6分钟，请耐心等待。多刷新几次，直到看到 Open WebUI 的登录界面。首次使用需要注册一个账号。</p><h3>Open WebUI 版本更新</h3><p>版本更新比较频繁，由于在 Azure App Service 创建时已经设置了 <code>Open WebUI/Open WebUI:main</code> 作为镜像的标签。所以只需要停止再启动 App Service 即可更新到最新版本，非常方便。稍微遗憾的是，App Service 底层的计算资源是随机分配的，所以每次重新部署时 Open WebUI 中已经保存的用户信息会丢失。咱们自己使用，重新注册一下就好了。</p><p>发现版本更新提示</p><p><img alt="Open WebUI new update" src="../assets/img/20250212_Azure_DeepSeek_Open_08.png"></p><p>停止再启动 App Service 后再访问 Open WebUI，发现已经更新到最新版本了。</p><p><img alt="Open WebUI updated" src="../assets/img/20250212_Azure_DeepSeek_Open_09.png"></p><h2>配置 Open WebUI 函数，以便连接到 Azure AI Foundry 部署的 DeepSeek</h2><p>首次打开 Open WebUI 会提示创建管理员账号，创建后即可登入。点击左下角用户名，弹出菜单中点击 “管理员面板”。</p><p><img alt="Open WebUI panel" src="../assets/img/20250212_Azure_DeepSeek_Open_10.png"></p><p>点击左侧“函数”菜单，然后点击“+”按钮。</p><p><img alt="Open WebUI function" src="../assets/img/20250212_Azure_DeepSeek_Open_11.png"></p><p>函数名称填写“DeepSeek”，函数描述填写 “DeepSeek from Azure AI Foundry”。 函数内容填写如下代码的内容，</p><p><a href="https://raw.githubusercontent.com/xfsnow/python/refs/heads/master/AzureAI/Open_WebUI_AAIF_DeepSeek.py">https://raw.githubusercontent.com/xfsnow/python/refs/heads/master/AzureAI/Open_WebUI_AAIF_DeepSeek.py</a></p><p>点击“保存”按钮，弹出确认层点确认即可。保存好后，点击函数右边的齿轮按钮，点击“默认” 2 字，可以输入自己的值。</p><p><img alt="Open WebUI Values" src="../assets/img/20250212_Azure_DeepSeek_Open_12.png"></p><p>在弹出的层里填入前面创建 DeepSeek 部署时记下的 3 个变量值，Azure Endpoint 填 Azure AI model inference endpoint，注意这里填写的是结尾为 /models 的 URL，比如 <a href="https://contoso-abcd1234-eastus2.services.ai.azure.com/models">https://contoso-abcd1234-eastus2.services.ai.azure.com/models</a> 。 Azure Api Key 填 Key，Azure Model Name 填 Model Name。</p><p>最后把函数最右侧圆点切换成启用。再占左上角“新对话”，模型选择菜单就会出现 DeepSeek 了。</p><p><img alt="Open WebUI new dialog" src="../assets/img/20250212_Azure_DeepSeek_Open_13.png"></p></main><footer class="footer"><div class="container"><div class="footer-content"><div class="footer-section"><h3><i class="fas fa-snowflake"></i> Snowpeak</h3><p>分享AI和云计算技术的最新动态与实践经验，以及其它有趣的话题。</p><div class="social-links"><div class="social-platforms"><a href="https://github.com/xfsnow" target="_blank" class="social-link"><i class="fab fa-github"></i></a><a href="https://snowpeak.blog.csdn.net/" target="_blank" class="social-link"><i class="fas fa-blog"></i></a><a href="https://space.bilibili.com/701839928" target="_blank" class="social-link"><i class="fab fa-bilibili"></i></a><a href="https://www.linkedin.com/in/snowpeak" target="_blank" class="social-link"><i class="fab fa-linkedin"></i></a></div><div class="wechat-section"><div class="wechat-info"><span class="wechat-label">微信公众号</span><span class="wechat-name">技术温暖生活</span></div><img src="/assets/img/techwarm.jpg" alt="技术温暖生活" class="wechat-qr"></div></div></div><div class="footer-section"><h4>快速链接</h4><ul><li><a href="/#articles">文章</a></li><li><a href="/#tools">工具</a></li><li><a href="https://docs.github.com/en/pages" target="_blank">GitHub Pages</a></li></ul></div><div class="footer-section"><h4>技术栈</h4><ul><li>Python</li><li>GitHub Copilot</li><li>Claude Sonnet 4</li><li>HTML/CSS/JS</li><li>响应式设计</li></ul></div></div><div class="footer-bottom"><p>Copyright &copy; 2013-<script>document.write((new Date()).getFullYear());</script> 雪峰博客。运行在 GitHub Pages 上。 <a href="https://beian.miit.gov.cn" target="_blank" class="icp_beian">京ICP备2021007720号</a><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502052523" target="_blank" class="gongan_beian">京公网安备11010502052523号</a></p></div></div></footer><script src="/zh/index.js"></script><script src="/assets/js/blog.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script><script>hljs.highlightAll(); if (window.location.hostname === 'www.snowpeak.org') { const script = document.createElement('script'); script.defer = true; script.src = 'https://static.cloudflareinsights.com/beacon.min.js'; script.dataset.cfBeacon = JSON.stringify({ "token": "4c2c021185e64942857a36d116eb4711" }); document.head.appendChild(script); } </script></body></html>